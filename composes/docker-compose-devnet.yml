version: '3'

services:
  node:
    image: tzlibre/tzlibre
    container_name: tzlibre_node
    volumes:
      - ./scripts:/scripts
      - ~/.tzlibre-node-devnet:/root/.tzlibre-node
      - ~/.tzlibre-client-devnet:/root/.tzlibre-client
    restart: on-failure
    ports:
      - 0.0.0.0:9732:9732
      - 127.0.0.1:8732:8732
    expose:
      - 9732
      - 8732
    command: bash -c 'sh /scripts/node.sh'
  baker:
    image: tzlibre/tzlibre
    container_name: tzlibre_baker
    volumes:
      - ./scripts:/scripts
    restart: on-failure
    command: bash -c 'sh /scripts/baker.sh'
  endorser:
    image: tzlibre/tzlibre
    container_name: tzlibre_endorser
    volumes:
      - ./scripts:/scripts
    restart: on-failure
    command: bash -c 'sh /scripts/endorser.sh'
  accuser:
    image: tzlibre/tzlibre
    container_name: tzlibre_accuser
    volumes:
      - ./scripts:/scripts
    restart: on-failure
    command: bash -c 'sh /scripts/accuser.sh'
  status:
    image: tzlibre/check-chain
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./scripts:/scripts
    command: bash -c '/scripts/check.sh'
